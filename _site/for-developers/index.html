<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <title>
      
        For developers - VAC Benefits Directory
      
    </title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="/assets/css/normalize.css">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
      <script src="/assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-102484926-9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-102484926-11', { 'anonymize_ip': true });
    </script>

  </head>
  <body>
    <div class="container">
      <header role="banner">
        <div class="wrap">
          
          <h1 class="site-title"><a class="title-link" href="/home/">Find benefits and services</a></h1>
          <h2 class="float-right"><a href="/technique/">Fran√ßais</a></h2>
        </div>
      </header>

      <div class="wrap content">

        <aside>
  <p class="intro">Help people find benefits that meet their needs.</p>
  <a class="skip-link visuallyhidden focusable" href="#main">Skip to Main Content</a>
  <nav class="sidebar-nav" role="navigation">
    <ul>
      
          <li><a href="/home/">Home</a></li>
      
          <li><a href="/features/">Features</a></li>
      
          <li><a href="/for-developers/">For developers</a></li>
      
          <li><a href="/for-content-managers/">For content managers</a></li>
      
          <li><a href="/contributing/">Contributing and open source</a></li>
      
          <li><a href="/contact/">Contact</a></li>
      
    </ul>
  </nav>
</aside>

        <section id="main" class="main-content" role="main">
          <h2 class="page-title">For developers</h2>


<section id="repositories">
    <h2>Repository</h2>
    <ul class="repo-list group">
      <li class="list-icon">
        <img src="https://raw.githubusercontent.com/cds-snc/find-benefits-and-services-documentation/master/assets/img/octocat.png" width="25px" alt="" />
      </li>
      
        <li>
          <a href="https://github.com/cds-snc/find-benefits-and-services">
            <h4>find-benefits-and-services</h4>
            <p>application code</p>
          </a>
        </li>
      
    </ul>
  </section>

<p>To create your own instance of this service, first you will need to install Yarn:</p>

<h2 id="install-yarn-on-os-x">Install Yarn on OS X</h2>

<ul>
  <li>Install the development environment
    <ul>
      <li><a href="https://brew.sh/">Homebrew</a></li>
      <li>node (<code class="highlighter-rouge">brew install node</code>)</li>
      <li>yarn (<code class="highlighter-rouge">npm i yarn</code>)</li>
    </ul>
  </li>
</ul>

<h2 id="install-yarn-on-windows">Install Yarn on Windows</h2>

<ul>
  <li>Download Node.JS of version 9 or newer(as .zip since .msi is blocked)</li>
  <li>To set up your newly installed Node command line tools such as npm globally:
    <ul>
      <li>Start menu &gt; Control Panel &gt; User accounts &gt; user accounts &gt; change my environment variables &gt; select path &gt; Edit</li>
      <li>Now enter the location where you have Node installed with a ; to separate between any other entries here. For example: <code class="highlighter-rouge">C:\dev ; C:\Node</code></li>
    </ul>
  </li>
  <li>Run <code class="highlighter-rouge">npm install -g yarn</code></li>
</ul>

<h2 id="running-the-app">Running the App</h2>

<ul>
  <li>Clone the repo
    <ul>
      <li><code class="highlighter-rouge">git clone git@github.com:cds-snc/find-benefits-and-services.git</code></li>
    </ul>
  </li>
  <li>Change directories to /find-benefits-and-services:
    <ul>
      <li><code class="highlighter-rouge">yarn install</code></li>
      <li><code class="highlighter-rouge">yarn dev</code></li>
      <li>If you run into syntax errors chances are there are missing packages/dependencies and you may want to try
running a clean yarn install. Delete node_modules folder and then re run <code class="highlighter-rouge">yarn install</code> in the main folder.</li>
    </ul>
  </li>
  <li>Now visit http://localhost:3000/ in your web browser and you should see an app that looks like <a href="http://benefits-avantages.cds-snc.ca">this</a>. Any changes you now make to your local version of the source code will be reflected on your localhost.</li>
  <li>Your local app is loading data from <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/data/data.json">data.json</a>. This includes which benefits are displayed, what the eligibility criteria is, which questions will be asked, and more! One way to modify this data is set up an instance of Airtable, which is described below. Another way would be to write the data to a number of csv files and then covert it into the json format shown in <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/data/data.json">data.json</a>.</li>
</ul>

<h2 id="airtable">Airtable</h2>

<p>By default, the application loads data from <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/data/data.json">data.json</a> as described in the previous section. We have also configured the application to read data from Airtable, which has an intuitive interface for entering / managing data. If you don‚Äôt want to use Airtable, see <a href="#what-if-i-dont-want-to-use-airtable">below</a>. The rest of these set up instructions will assume that you are using Airtable.</p>

<p>We‚Äôve set up a <a href="https://Airtable.com/shr5bRGUxt32qiqRm">demo Airtable base</a> with some sample data. If you wish to enable Airtable as the source for your data, follow the instructions in this section.</p>

<ul>
  <li>Visit our <a href="https://Airtable.com/shr5bRGUxt32qiqRm">demo Airtable base</a> and click ‚ÄúCopy base‚Äù</li>
  <li>If you don‚Äôt already have an Airtable account, you‚Äôll be prompted to create one</li>
  <li>Add the base to one of your workspaces</li>
</ul>

<p>Now you‚Äôll need to set up some local environment variables to get the content from your Airtable base into your app.</p>

<h2 id="adding-environment-variables">Adding environment variables</h2>

<p>Add the following 4 environment variables using the steps below.</p>

<table>
  <thead>
    <tr>
      <th>Variable</th>
      <th>Use</th>
      <th>Required</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">AIRTABLE_READ_KEY</code></td>
      <td>Load data (benefits / translations / etc) from Airtable. This value is your API Key for your account on Airtable. To generate this key, visit your <a href="https://Airtable.com/account">account page</a> and click on the ‚ÄúGenerate my API key‚Äù</td>
      <td>yes</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">AIRTABLE_BASE_KEY</code></td>
      <td>This tells the app which Airtable base to pull data from. To locate this key, visit your Airtable base and click: help &gt; API documentation. Then copy the base key from your current URL, which will have the format: <code class="highlighter-rouge">https://airtable.com/AIRTABLE_BASE_KEY/api/docs</code></td>
      <td>yes</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">USE_AIRTABLE</code></td>
      <td><code class="highlighter-rouge">true</code> = pull data directly from Airtable, <code class="highlighter-rouge">false</code> = pull data from <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/data.json">data.json</a></td>
      <td>yes</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">AIRTABLE_WRITE_KEY</code></td>
      <td>Write feedback form data to Airtable. If the API key for your account has write permissions to your Airtable base, you can use the same value for this variable.</td>
      <td>only if you want the feedback feature to work</td>
    </tr>
  </tbody>
</table>

<h3 id="adding-a-new-environment-locally-os-x">Adding a new environment locally (OS X)</h3>

<ol>
  <li>In the terminal, run: <code class="highlighter-rouge">nano ~/.bash_profile</code> (or <code class="highlighter-rouge">nano ~/.zshrc</code> if you‚Äôre using the zsh shell)</li>
  <li>Add the following line: <code class="highlighter-rouge">export AIRTABLE_READ_KEY="foo"</code></li>
  <li>[ctrl] + x, and type <code class="highlighter-rouge">y</code> to save</li>
  <li><code class="highlighter-rouge">source ~/.bash_profile</code> (or <code class="highlighter-rouge">source ~/.zshrc</code>)</li>
  <li><code class="highlighter-rouge">echo $AIRTABLE_READ_KEY</code> to make sure it is set</li>
</ol>

<p>Repeat these steps for each of the 4 environment variables in the table above.</p>

<h3 id="adding-a-new-environment-locally-windows-7">Adding a new environment locally (Windows 7)</h3>

<ol>
  <li>Visit: Start Menu &gt; Control Panel &gt; User Accounts &gt; User Accounts &gt; Change my environment variables &gt; New‚Ä¶</li>
  <li>Add a variable called <code class="highlighter-rouge">AIRTABLE_READ_KEY</code></li>
  <li>Restart the Command Prompt, run <code class="highlighter-rouge">echo %AIRTABLE_READ_KEY%</code> to check if the new varaible exists</li>
</ol>

<p>Repeat these steps for each of the 4 environment variables in the table above.</p>

<h2 id="make-a-content-change-using-airtable">Make a content change using Airtable</h2>

<ul>
  <li>run <code class="highlighter-rouge">yarn dev</code></li>
  <li>visit http://localhost:3000/</li>
</ul>

<p>üéâ Congratulations! You should now be viewing content pulled directly from your new Airtable base. To test that it‚Äôs working, change the name of one of the benefits.</p>

<ul>
  <li>navigate to the benefits table</li>
  <li>change the 1st row 1st column ‚ÄúBenefit 1‚Äù to ‚ÄúMy Awesome Benefit‚Äù</li>
  <li>navigate to http://localhost:3000/data-validation</li>
  <li>click ‚Äúrefresh cache‚Äù</li>
  <li>visit http://localhost:3000/benefits-directory</li>
  <li>You should see your new name displayed on the 1st benefit card</li>
</ul>

<h2 id="adding-in-your-new-content-and-eligibility">Adding in your new content and eligibility</h2>

<p>You can now start customizing the content in the app to suite your use case. Our <a href="/for-content-managers">guide to changing content</a> will help you get started with that. Note that there are two options for loading content into your app going forward:</p>

<ol>
  <li>Load content and logic directly from your Airtable base (<code class="highlighter-rouge">USE_AIRTABLE = "true"</code>). This is great for development and quickly seeing your changes in the live app.</li>
  <li>Load content from <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/data.json">data.json</a>. This is a good option when your app is live and and content changes may be less frequent and require more peer review. To choose this option, remove the <code class="highlighter-rouge">USE_Airtable</code> environment variable from your environment. To make a pull new content into the app, run <code class="highlighter-rouge">yarn download</code>. This copies the most recent Airtable data to <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/data/data.json">data.json</a>.</li>
</ol>

<h2 id="what-if-i-dont-want-to-use-airtable">What if I don‚Äôt want to use Airtable?</h2>

<p>It is also possible to not use Airtable. An alternative method would be to store and edit your content and logic in another spreadsheet application like Excel or Google Sheets. You could then export csv files and parse these into the same json format we use in <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/data/data.json">data.json</a>. If you take this approach, <a href="https://github.com/d3/d3-dsv">d3.dsv</a> may be helpful.</p>

<h2 id="reference">Reference</h2>

<p>If you‚Äôd like to contribute to the project, refer to the detailed documentation regarding our tech choices <a href="https://github.com/cds-snc/find-benefits-and-services/blob/master/doc/en/TECH_CHOICES.md">here</a>.</p>

<p>This application uses the following resources:</p>

<ul>
  <li>NextJS <a href="https://learnnextjs.com/">https://learnnextjs.com/</a></li>
  <li>Jest <a href="https://facebook.github.io/jest/">https://facebook.github.io/jest/</a></li>
  <li>Prettier <a href="https://prettier.io/">https://prettier.io/</a></li>
</ul>


        </section>

      </div><!-- /.wrap content -->

      <footer role="contentinfo">
        <div class="wrap">
          <p>This project was built by the <a href="https://digital.canada.ca">Canadian Digital Service</a>.</p>
          <p><a href="https://github.com/cds-snc/find-benefits-and-services-documentation">Contribute to this documentation.</a></p>
          <p>Hosted on <a href="http://pages.github.com/">GitHub Pages</a>.</p>
        </div><!--/.wrap -->
      </footer>
    </div> <!-- /.container -->
    
    </body>
</html>
